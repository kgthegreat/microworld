class LedgerController < ApplicationController
 def index
      @users = User.all
      @ledgers= Ledger.all
      @groups=Group.all
logger.info"**************************"+params[:ledger].inspect
      respond_to do |format|
      format.html # index.html.erb
      format.xml  { render :xml => @ledgers }
	end# end of loop
     end#end of index
 
 def show_user

 @ledger=Ledger.new
logger.info"**************************"+params[:ledger].inspect
      @group=Group.find(params[:group][:group_id])
      @users = @group.users

      respond_to do |format|
      format.html # new.html.erb
      end#end of method
    end
def show
   
	@ledger = Ledger.find(params[:id])
    respond_to do |format|
      format.html # show.html.erb
      format.xml  { render :xml => @ledger }
    end
  end
def new
      @ledger=Ledger.new
      @groups=Group.all
      @user=User.all
      #@user = User.new 	
      respond_to do |format|
      format.html # show.html.erb
      end
    end

def create
    #@ledger = Ledger.new(params[:ledger])
     @group=Group.find(params[:group_id])
	 @users =@group.users
	 @users.each do |user|
	   if params["#{user.id}"] [:amount]
	      @ledger= Ledger.new
logger.info"**************************"+params[:ledger].inspect
		  @ledger.user_id = params["#{user.id}"][:user_id].to_i
                  @user = User.find(user)
                  @user.totalamount = @user.totalamount + params["#{user.id}"][:amount].to_i
 		  # @ledger.amount = params["#{user.id}"][:amount].to_i
		  #user.amount = params["#{user.id}"][:amount].to_i
		  @user.save
		  @ledger.save
	 end
	 end
        flash[:notice] = 'Amount was successfully updated.'
        redirect_to :controller=>"users",:action=>"index",:id=>@users
end

def update
   	@ledger = Ledger.new(params[:ledger])
@user= User.find(:all)
	respond_to do |format|
	if @ledger.update_attributes(params[:ledger])
	flash[:notice] = 'Ledger was successfully updated.'
	format.html {redirect_to (@ledger) }
	else
	format.html {render :action => 'edit' }
       	end
    end
  end
def destroy
    @ledger = Ledger.find(params[:id])
    @ledger.destroy
    respond_to do |format|
      format.html { redirect_to(ledger_url) }
      format.xml  { head :ok }
    end
  end
end
